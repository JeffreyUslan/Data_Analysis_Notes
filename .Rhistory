noise=rnorm(len,mean=0,sd=1)
heteroscedastic_noise=rnorm(len,mean=0,sd=ts)
sin_1=sin(1*w*ts)
sin_2=sin(2*w*ts)
sin_4=sin(4*w*ts)
sin_8=sin(8*w*ts)
var_pres=sin_1+sin_2+sin_4+sin_8+noise
plot(var_pres)
var_pres=sin_1+sin_2+sin_4+sin_8
plot(var_pres)
sin_1=sin(1*w*ts)
ts       <- seq(1,time,1/len)
head(ts)
ts       <- seq(0,time,1/len)
head(ts)
ts       <- seq(time/len,time,1/len)
noise=rnorm(len,mean=0,sd=1)
heteroscedastic_noise=rnorm(len,mean=0,sd=ts)
sin_1=sin(1*w*ts)
sin_2=sin(2*w*ts)
sin_4=sin(4*w*ts)
sin_8=sin(8*w*ts)
var_pres=sin_1+sin_2+sin_4+sin_8+noise
plot(var_pres)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise
plot(var_pres)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+ts
plot(var_pres)
?lowess
lowess(var_pres)
plot(lowess(var_pres))
plot(var_pres)
plot(var_pres)
lines(lowess(var_pres))
plot(ts)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+x
plot(var_pres)
plot(var_pres)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
plot(var_pres)
lines(lowess(var_pres))
lines(runmed((var_pres),len/100))
lines(runmed((var_pres),len/10))
lines(runmed((var_pres),len/10),color="green")
lines(runmed((var_pres),len/10),color="g")
?lines
lines(runmed((var_pres),len/10),col="blue")
plot(var_pres)
lines(lowess(var_pres))
lines(runmed((var_pres),len/100),col="blue")
lines(runmed((var_pres),len/10),col="red")
lines(runmed((var_pres),len/5),col="green")
acf(var_pres)
lm(var_pres~x)
predict(lm(var_pres~x))
line_fit=predict(lm(var_pres~x))
acf(var_pres-line_fit)
plot(var_pres)
set.seed(1)
acq.freq <- 200
t=seq(1,acq.freq+1)
time     <- 1
w        <- 2*pi/time
ts       <- seq(0,time,1/acq.freq)
t_clean=4*sin(3*w*ts)
fft_t_clean=fft(t_clean)
plot(Mod(fft_t_clean)[0:(acq.freq/2)])
t1 <- t_clean +3*rnorm(acq.freq+1)
plot(Mod(fft(t1))[0:(acq.freq/2)])
trajectory <- t1+seq(1,acq.freq+1)/10
plot(Mod(fft(trajectory))[0:(acq.freq/2)])
plot(trajectory, type="l")
lines(t1, type="l",col="blue")
lines(t_clean, type="l",col="red")
#Is there lost information? No
X.k <- fft(trajectory)
X.unf=fft(X.k,inverse=TRUE)/length(trajectory)
X.unf=Mod(X.unf)
plot(X.unf,type="l")
lines(trajectory, type="l",col="blue")
mean(abs(X.unf-trajectory))
X.hold=fft(t1)
plot(Mod(X.hold)[0:(acq.freq/2)])
thresh= 200
hist(X.hold)
hist(Mod(X.hold))
head(Mod(X.hold))
?order
head(order(Mod(X.hold)))
max(Mod(X.hold))
head(Mod(X.hold)[order(Mod(X.hold))])
head(Mod(X.hold)[order(Mod(X.hold),decreasing=TRUE)])
head(Mod(X.hold)[order(Mod(X.hold),decreasing=TRUE)])
plot(Mod(X.hold)[0:(acq.freq/2)])
Mod(X.hold)[order(Mod(X.hold),decreasing=TRUE)]
order(Mod(X.hold),decreasing=TRUE)
lm_model=lm(var_pres~x)
plot(lm(var_pres~x))
len=1000
#time indicator
x=seq(1:len)
time     <- 1
w        <- 2*pi/time
ts       <- seq(time/len,time,1/len)
#simple noise
noise=rnorm(len,mean=0,sd=1)
#heteroscedastic noise
heteroscedastic_noise=rnorm(len,mean=0,sd=ts)
#sinusoidals
sin_1=sin(1*w*ts)
sin_2=sin(2*w*ts)
sin_4=sin(4*w*ts)
sin_8=sin(8*w*ts)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
plot(var_pres)
?filter
plot(var_pres)
lines(lowess(var_pres))
lines(filter(var_pres,c(3),sides=1),col="blue")
lines(filter(var_pres,rep(1/3,3),sides=1),col="blue")
plot(var_pres)
lines(lowess(var_pres))
lines(filter(var_pres,rep(1/3,3),sides=1),col="blue")
plot(var_pres)
lines(filter(var_pres,rep(1/3,3),sides=1),col="blue")
lines(filter(var_pres,rep(1/7,7),sides=1),col="green")
lines(filter(var_pres,rep(1/5,5),sides=1),col="red")
plot(var_pres)
lines(filter(var_pres,rep(1/3,3),sides=1),col="blue")
lines(filter(var_pres,rep(1/5,5),sides=1),col="red")
lines(filter(var_pres,rep(1/7,7),sides=1),col="green")
plot(var_pres)
lines(filter(var_pres,rep(1/2,2),sides=1),col="blue")
lines(filter(var_pres,rep(1/4,4),sides=1),col="red")
lines(filter(var_pres,rep(1/8,8),sides=1),col="green")
lines(filter(var_pres,rep(1/16,16),sides=1),col="green")
lines(filter(var_pres,rep(1/16,16),sides=1),col="yellow")
lines(filter(var_pres,rep(1/32,32),sides=1),col="yellow")
plot(var_pres)
lines(filter(var_pres,rep(1/2,2),sides=1),col="red")
lines(filter(var_pres,rep(1/4,4),sides=1),col="green3")
lines(filter(var_pres,rep(1/8,8),sides=1),col="blue")
lines(filter(var_pres,rep(1/16,16),sides=1),col="cyan")
lines(filter(var_pres,rep(1/32,32),sides=1),col="magenta")
lines(filter(var_pres,rep(1/64,64),sides=1),col="yellow")
lm_model=lm(var_pres~x)
plot(lm_model)
line_fit=predict(lm_model)
acf(var_pres-line_fit)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
plot(final_sim)
lines(filter(final_sim,rep(1/2,2),sides=1),col="red")
lines(filter(final_sim,rep(1/4,4),sides=1),col="green3")
lines(filter(final_sim,rep(1/8,8),sides=1),col="blue")
lines(filter(final_sim,rep(1/16,16),sides=1),col="cyan")
lines(filter(final_sim,rep(1/32,32),sides=1),col="magenta")
lines(filter(final_sim,rep(1/64,64),sides=1),col="yellow")
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
acf(clean_1)
acf(clean_1)
X.hold=fft(clean_1)
order(Mod(X.hold),decreasing=TRUE)
length(X.hold)
X.hold=fft(clean_1)[1:len/2]
order(Mod(X.hold),decreasing=TRUE)
plot(X.hold)
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
order(Mod(X.hold),decreasing=TRUE)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
head(ordered_ind)
head(X.hold[ordered_ind])
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
plot(clean_1)
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
plot(sin_1+sin_2+sin_4+sin_8)
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_2+sin_4+sin_8
plot(clean_period)
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_2+sin_4+sin_8
plot(clean_period)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
plot(clean_1)
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
X.hold=Mod(fft(filter(clean_1,rep(1/2,2),sides=1))[1:len/2])
plot(X.hold)
X.hold=Mod(fft(filter(clean_1,rep(1/2,2),sides=1))[1:len/2])
plot(X.hold)
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
len=1000
#time indicator
x=seq(1:len)
time     <- 1
w        <- 2*pi/time
ts       <- seq(time/len,time,1/len)
#simple noise
noise=rnorm(len,mean=0,sd=.5)
#heteroscedastic noise
heteroscedastic_noise=rnorm(len,mean=0,sd=ts*.5)
#sinusoidals
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
len=1000
#time indicator
x=seq(1:len)
time     <- 1
w        <- 2*pi/time
ts       <- seq(time/len,time,1/len)
#simple noise
noise=rnorm(len,mean=0,sd=.1)
#heteroscedastic noise
heteroscedastic_noise=rnorm(len,mean=0,sd=ts*.1)
#sinusoidals
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
noise=rnorm(len,mean=0,sd=.3)
#heteroscedastic noise
heteroscedastic_noise=rnorm(len,mean=0,sd=ts*.3)
#sinusoidals
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(4*w*ts)
sin_8=(1/4)*sin(8*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
#remove linear trend
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
acf(clean_1)
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
head(X.hold[ordered_ind])
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(2*w*ts)
sin_4=(1/3)*sin(16*w*ts)
sin_8=(1/4)*sin(64*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
acf(clean_1)
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
head(X.hold[ordered_ind])
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(16*w*ts)
sin_4=(1/3)*sin(64*w*ts)
sin_8=(1/4)*sin(256*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
sin_1=sin(4*w*ts)
sin_2=(1/2)*sin(12*w*ts)
sin_4=(1/3)*sin(52*w*ts)
sin_8=(1/4)*sin(265*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
sin_1=sin(2*w*ts)
sin_2=(1/2)*sin(12*w*ts)
sin_4=(1/3)*sin(52*w*ts)
sin_8=(1/4)*sin(265*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
sin_1=sin(2*w*ts)
sin_2=(1/2)*sin(6*w*ts)
sin_4=(1/3)*sin(26*w*ts)
sin_8=(1/4)*sin(133*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
sin_1=sin(1*w*ts)
sin_2=(1/2)*sin(6*w*ts)
sin_8=(1/4)*sin(133*w*ts)
sin_4=(1/3)*sin(26*w*ts)
clean_period=sin_1+sin_2+sin_4+sin_8
plot(clean_period)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+heteroscedastic_noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
acf(clean_1)
X.hold=Mod(fft(clean_1)[1:len/2])
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
head(X.hold[ordered_ind])
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
plot(clean_period)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
plot(clean_1)
lines(filter(clean_1,rep(1/2,2),sides=1),col="red")
lines(filter(clean_1,rep(1/4,4),sides=1),col="green3")
lines(filter(clean_1,rep(1/8,8),sides=1),col="blue")
lines(filter(clean_1,rep(1/16,16),sides=1),col="cyan")
lines(filter(clean_1,rep(1/32,32),sides=1),col="magenta")
plot(clean_1)
filt_1=filter(clean_1,rep(1/2,2)
filt_2=filter(clean_1,rep(1/4,4)
filt_3=filter(clean_1,rep(1/8,8)
filt_4=filter(clean_1,rep(1/16,16)
filt_5=filter(clean_1,rep(1/32,32)
filt_1=filter(clean_1,rep(1/2,2))
filt_1=filter(clean_1,rep(1/2,2))
filt_2=filter(clean_1,rep(1/4,4))
filt_3=filter(clean_1,rep(1/8,8))
filt_4=filter(clean_1,rep(1/16,16))
filt_5=filter(clean_1,rep(1/32,32))
lines(filt_1,sides=1),col="red")
lines(filt_1,col="red")
lines(filt_2,col="green3")
lines(filt_3,col="blue")
lines(filt_4,col="cyan")
lines(filt_5,col="magenta")
acf(filt_1)
filt_1
acf(na.rm(filt_1))
acf(na.omit(filt_1))
acf(na.omit(filt_2))
acf(na.omit(filt_3))
acf(na.omit(filt_4))
acf(na.omit(filt_5))
acf(na.omit(filt_1))
X.hold=Mod(fft(filt_1))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
X.hold=X.hold[1:length(X.hold)/2]
plot9X.hold
plot(X.hold)
X.hold=Mod(fft(filt_1))
X.hold=Mod(fft(na.omit(filt_1)))
plot(X.hold)
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind)
head(X.hold[ordered_ind])
hist(X.hold)
X.hold=Mod(fft(na.omit(filt_2)))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
X.hold=Mod(fft(na.omit(filt_3)))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
X.hold=Mod(fft(na.omit(filt_1)))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
median(X.hold)
X.hold=Mod(fft(na.omit(clean_1)))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
?head
head(ordered_ind,n=20)
head(X.hold[ordered_ind],n=20)
var_pres=sin_1+sin_2+sin_4+sin_8+noise+.01*x
final_sim=var_pres+c(rep(0,1),var_pres[2:len])+c(rep(0,2),var_pres[3:len])+c(rep(0,3),var_pres[4:len])
plot(final_sim)
lm_model=lm(final_sim~x)
line_fit=predict(lm_model)
lines(line_fit,col="yellow")
clean_1=final_sim-line_fit
plot(clean_1)
filt_1=filter(clean_1,rep(1/2,2))
filt_2=filter(clean_1,rep(1/4,4))
filt_3=filter(clean_1,rep(1/8,8))
filt_4=filter(clean_1,rep(1/16,16))
filt_5=filter(clean_1,rep(1/32,32))
lines(filt_1,col="red")
lines(filt_2,col="green3")
lines(filt_3,col="blue")
lines(filt_4,col="cyan")
lines(filt_5,col="magenta")
acf(na.omit(filt_2))
acf(na.omit(filt_1))
X.hold=Mod(fft(na.omit(clean_1)))
X.hold=X.hold[1:length(X.hold)/2]
plot(X.hold)
ordered_ind=order(X.hold,decreasing=TRUE)
head(ordered_ind,n=20)
head(X.hold[ordered_ind],n=20)
head(ordered_ind,n=10)
